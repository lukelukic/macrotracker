æ
ƒD:\macrotracker\MacroTracker\Macrotracker.Users.Infrastructure\DataAccess\EfDataAccess\EntityConfigurations\TrainerConfiguration.cs
	namespace 	
Macrotracker
 
. 
Users 
. 
Infrastructure +
.+ ,

DataAccess, 6
.6 7
EfDataAccess7 C
.C D 
EntityConfigurationsD X
{ 
public 

class  
TrainerConfiguration %
:& '$
IEntityTypeConfiguration( @
<@ A
TrainerA H
>H I
{		 
public

 
void

 
	Configure

 
(

 
EntityTypeBuilder

 /
<

/ 0
Trainer

0 7
>

7 8
builder

9 @
)

@ A
{ 	
builder 
. 
HasBaseType 
<  
User  $
>$ %
(% &
)& '
;' (
} 	
} 
} Ó
‹D:\macrotracker\MacroTracker\Macrotracker.Users.Infrastructure\DataAccess\EfDataAccess\EntityConfigurations\TrainingRequestConfiguration.cs
	namespace 	
Macrotracker
 
. 
Users 
. 
Infrastructure +
.+ ,

DataAccess, 6
.6 7
EfDataAccess7 C
.C D 
EntityConfigurationsD X
{ 
public 

class (
TrainingRequestConfiguration -
:. /$
IEntityTypeConfiguration0 H
<H I
TrainingRequestI X
>X Y
{ 
public		 
void		 
	Configure		 
(		 
EntityTypeBuilder		 /
<		/ 0
TrainingRequest		0 ?
>		? @
builder		A H
)		H I
{

 	
builder 
. 
HasQueryFilter "
(" #
r# $
=>% '
r( )
.) *
IsActive* 2
)2 3
;3 4
builder 
. 
HasOne 
( 
r 
=> 
r  !
.! "
User" &
)& '
.' (
WithMany( 0
(0 1
u1 2
=>3 5
u6 7
.7 8
SentRequests8 D
)D E
;E F
builder 
. 
HasOne 
( 
r 
=> 
r  !
.! "
Trainer" )
)) *
.* +
WithMany+ 3
(3 4
t4 5
=>6 8
t9 :
.: ;
RecievedRequests; K
)K L
.L M
OnDeleteM U
(U V
DeleteBehaviorV d
.d e
Restricte m
)m n
;n o
} 	
} 
} ¹
€D:\macrotracker\MacroTracker\Macrotracker.Users.Infrastructure\DataAccess\EfDataAccess\EntityConfigurations\UserConfiguration.cs
	namespace 	
MacroTracker
 
. 
Users 
. 
Infrastructure +
.+ , 
EntityConfigurations, @
{ 
public 

class 
UserConfiguration "
:# $$
IEntityTypeConfiguration% =
<= >
User> B
>B C
{		 
public

 
void

 
	Configure

 
(

 
EntityTypeBuilder

 /
<

/ 0
User

0 4
>

4 5
builder

6 =
)

= >
{ 	
builder 
. 
HasDiscriminator !
<! "
string" (
>( )
() *
$str* 5
)5 6
. 
HasValue 
< 
User 
> 
(  
$str  &
)& '
. 
HasValue 
< 
Trainer !
>! "
(" #
$str# ,
), -
;- .
builder 
. 
HasAlternateKey #
(# $
u$ %
=>& (
u) *
.* +
Email+ 0
)0 1
;1 2
builder 
. 
HasAlternateKey #
(# $
u$ %
=>& (
u) *
.* +
Username+ 3
)3 4
;4 5
builder 
. 
Property 
( 
u 
=> !
u" #
.# $
	FirstName$ -
)- .
.. /
HasMaxLength/ ;
(; <
$num< >
)> ?
;? @
builder 
. 
Property 
( 
u 
=> !
u" #
.# $
LastName$ ,
), -
.- .
HasMaxLength. :
(: ;
$num; =
)= >
;> ?
builder 
. 
Property 
( 
u 
=> !
u" #
.# $
Email$ )
)) *
.* +
HasMaxLength+ 7
(7 8
$num8 ;
); <
;< =
builder 
. 
Property 
( 
u 
=> !
u" #
.# $
Password$ ,
), -
.- .
HasMaxLength. :
(: ;
$num; >
)> ?
;? @
builder 
. 
HasQueryFilter "
(" #
r# $
=>% '
r( )
.) *
IsActive* 2
)2 3
;3 4
} 	
} 
} Ú
vD:\macrotracker\MacroTracker\Macrotracker.Users.Infrastructure\DataAccess\EfDataAccess\Extensions\ContextExtensions.cs
	namespace 	
MacroTracker
 
. 
Users 
. 
Infrastructure +
.+ ,

Extensions, 6
{ 
public		 

static		 
class		 
ContextExtensions		 )
{

 
public 
static 
void $
SetCreatedUpdatedAtDates 3
(3 4
this4 8
IEnumerable9 D
<D E
EntityEntryE P
>P Q
entriesR Y
)Y Z
{ 	
foreach 
( 
var 
entry 
in !
entries" )
)) *
{ 
if 
( 
entry 
. 
Entity  
is! #
Entity$ *
e+ ,
), -
{ 
switch 
( 
entry !
.! "
State" '
)' (
{ 
case 
EntityState (
.( )
Modified) 1
:1 2
e 
. 
	UpdatedAt '
=( )
DateTime* 2
.2 3
Now3 6
;6 7
break !
;! "
case 
EntityState (
.( )
Added) .
:. /
e 
. 
	CreatedAt '
=( )
DateTime* 2
.2 3
Now3 6
;6 7
e 
. 
IsActive &
=' (
true) -
;- .
break !
;! "
} 
} 
} 
} 	
public   
static   
void   !
ConfigureJoinEntities   0
(  0 1
this  1 5
ModelBuilder  6 B
builder  C J
)  J K
{!! 	
builder"" 
."" 
Entity"" 
<"" 
TrainerUser"" &
>""& '
(""' (
)""( )
."") *
HasKey""* 0
(""0 1
tu""1 3
=>""4 6
new""7 :
{""; <
tu""= ?
.""? @
	TrainerId""@ I
,""I J
tu""K M
.""M N
UserId""N T
}""U V
)""V W
;""W X
builder$$ 
.$$ 
Entity$$ 
<$$ 
TrainerUser$$ &
>$$& '
($$' (
)$$( )
.%% 
HasOne%% 
(%% 
tu%% 
=>%% 
tu%%  
.%%  !
Trainer%%! (
)%%( )
.&& 
WithMany&& 
(&& 
t&& 
=>&& 
t&&  
.&&  !
TrainerUsers&&! -
)&&- .
.'' 
HasForeignKey'' 
('' 
tu'' !
=>''" $
tu''% '
.''' (
	TrainerId''( 1
)''1 2
.(( 
OnDelete(( 
((( 
DeleteBehavior(( (
.((( )
Restrict(() 1
)((1 2
;((2 3
builder** 
.** 
Entity** 
<** 
TrainerUser** &
>**& '
(**' (
)**( )
.++ 
HasOne++ 
(++ 
tu++ 
=>++ 
tu++  
.++  !
User++! %
)++% &
.,, 
WithMany,, 
(,, 
t,, 
=>,, 
t,,  
.,,  !
UserTrainers,,! -
),,- .
.-- 
HasForeignKey-- 
(-- 
tu-- !
=>--" $
tu--% '
.--' (
UserId--( .
)--. /
... 
OnDelete.. 
(.. 
DeleteBehavior.. (
...( )
Cascade..) 0
)..0 1
;..1 2
}// 	
}00 
}11 Þa
{D:\macrotracker\MacroTracker\Macrotracker.Users.Infrastructure\DataAccess\EfDataAccess\Migrations\20190106203625_Initial.cs
	namespace 	
MacroTracker
 
. 
Users 
. 
Infrastructure +
.+ ,

Migrations, 6
{ 
public 

partial 
class 
Initial  
:! "
	Migration# ,
{ 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{		 	
migrationBuilder

 
.

 
CreateTable

 (
(

( )
name 
: 
$str 
, 
columns 
: 
table 
=> !
new" %
{ 
Id 
= 
table 
. 
Column %
<% &
Guid& *
>* +
(+ ,
nullable, 4
:4 5
false6 ;
); <
,< =
	CreatedAt 
= 
table  %
.% &
Column& ,
<, -
DateTime- 5
>5 6
(6 7
nullable7 ?
:? @
falseA F
)F G
,G H
	UpdatedAt 
= 
table  %
.% &
Column& ,
<, -
DateTime- 5
>5 6
(6 7
nullable7 ?
:? @
falseA F
)F G
,G H
IsActive 
= 
table $
.$ %
Column% +
<+ ,
bool, 0
>0 1
(1 2
nullable2 :
:: ;
false< A
)A B
,B C
Name 
= 
table  
.  !
Column! '
<' (
string( .
>. /
(/ 0
	maxLength0 9
:9 :
$num; =
,= >
nullable? G
:G H
falseI N
)N O
} 
, 
constraints 
: 
table "
=># %
table& +
.+ ,

PrimaryKey, 6
(6 7
$str7 A
,A B
xC D
=>E G
xH I
.I J
IdJ L
)L M
)M N
;N O
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str 
, 
columns 
: 
table 
=> !
new" %
{ 
Id 
= 
table 
. 
Column %
<% &
Guid& *
>* +
(+ ,
nullable, 4
:4 5
false6 ;
); <
,< =
	CreatedAt 
= 
table  %
.% &
Column& ,
<, -
DateTime- 5
>5 6
(6 7
nullable7 ?
:? @
falseA F
)F G
,G H
	UpdatedAt 
= 
table  %
.% &
Column& ,
<, -
DateTime- 5
>5 6
(6 7
nullable7 ?
:? @
falseA F
)F G
,G H
IsActive 
= 
table $
.$ %
Column% +
<+ ,
bool, 0
>0 1
(1 2
nullable2 :
:: ;
false< A
)A B
,B C
	FirstName 
= 
table  %
.% &
Column& ,
<, -
string- 3
>3 4
(4 5
	maxLength5 >
:> ?
$num@ B
,B C
nullableD L
:L M
trueN R
)R S
,S T
LastName 
= 
table $
.$ %
Column% +
<+ ,
string, 2
>2 3
(3 4
	maxLength4 =
:= >
$num? A
,A B
nullableC K
:K L
trueM Q
)Q R
,R S
Email   
=   
table   !
.  ! "
Column  " (
<  ( )
string  ) /
>  / 0
(  0 1
	maxLength  1 :
:  : ;
$num  < ?
,  ? @
nullable  A I
:  I J
false  K P
)  P Q
,  Q R
Password!! 
=!! 
table!! $
.!!$ %
Column!!% +
<!!+ ,
string!!, 2
>!!2 3
(!!3 4
	maxLength!!4 =
:!!= >
$num!!? B
,!!B C
nullable!!D L
:!!L M
true!!N R
)!!R S
,!!S T
Username"" 
="" 
table"" $
.""$ %
Column""% +
<""+ ,
string"", 2
>""2 3
(""3 4
nullable""4 <
:""< =
false""> C
)""C D
}## 
,## 
constraints$$ 
:$$ 
table$$ "
=>$$# %
{%% 
table&& 
.&& 

PrimaryKey&& $
(&&$ %
$str&&% /
,&&/ 0
x&&1 2
=>&&3 5
x&&6 7
.&&7 8
Id&&8 :
)&&: ;
;&&; <
table'' 
.'' 
UniqueConstraint'' *
(''* +
$str''+ ;
,''; <
x''= >
=>''? A
x''B C
.''C D
Email''D I
)''I J
;''J K
table(( 
.(( 
UniqueConstraint(( *
(((* +
$str((+ >
,((> ?
x((@ A
=>((B D
x((E F
.((F G
Username((G O
)((O P
;((P Q
})) 
))) 
;)) 
migrationBuilder++ 
.++ 
CreateTable++ (
(++( )
name,, 
:,, 
$str,, #
,,,# $
columns-- 
:-- 
table-- 
=>-- !
new--" %
{.. 
	TrainerId// 
=// 
table//  %
.//% &
Column//& ,
<//, -
Guid//- 1
>//1 2
(//2 3
nullable//3 ;
://; <
false//= B
)//B C
,//C D
UserId00 
=00 
table00 "
.00" #
Column00# )
<00) *
Guid00* .
>00. /
(00/ 0
nullable000 8
:008 9
false00: ?
)00? @
}11 
,11 
constraints22 
:22 
table22 "
=>22# %
{33 
table44 
.44 

PrimaryKey44 $
(44$ %
$str44% 5
,445 6
x447 8
=>449 ;
new44< ?
{44@ A
x44B C
.44C D
	TrainerId44D M
,44M N
x44O P
.44P Q
UserId44Q W
}44X Y
)44Y Z
;44Z [
table55 
.55 

ForeignKey55 $
(55$ %
name66 
:66 
$str66 >
,66> ?
column77 
:77 
x77  !
=>77" $
x77% &
.77& '
	TrainerId77' 0
,770 1
principalTable88 &
:88& '
$str88( /
,88/ 0
principalColumn99 '
:99' (
$str99) -
,99- .
onDelete::  
:::  !
ReferentialAction::" 3
.::3 4
Restrict::4 <
)::< =
;::= >
table;; 
.;; 

ForeignKey;; $
(;;$ %
name<< 
:<< 
$str<< ;
,<<; <
column== 
:== 
x==  !
=>==" $
x==% &
.==& '
UserId==' -
,==- .
principalTable>> &
:>>& '
$str>>( /
,>>/ 0
principalColumn?? '
:??' (
$str??) -
,??- .
onDelete@@  
:@@  !
ReferentialAction@@" 3
.@@3 4
Restrict@@4 <
)@@< =
;@@= >
}AA 
)AA 
;AA 
migrationBuilderCC 
.CC 
CreateTableCC (
(CC( )
nameDD 
:DD 
$strDD  
,DD  !
columnsEE 
:EE 
tableEE 
=>EE !
newEE" %
{FF 
UserIdGG 
=GG 
tableGG "
.GG" #
ColumnGG# )
<GG) *
GuidGG* .
>GG. /
(GG/ 0
nullableGG0 8
:GG8 9
falseGG: ?
)GG? @
,GG@ A
RoleIdHH 
=HH 
tableHH "
.HH" #
ColumnHH# )
<HH) *
GuidHH* .
>HH. /
(HH/ 0
nullableHH0 8
:HH8 9
falseHH: ?
)HH? @
}II 
,II 
constraintsJJ 
:JJ 
tableJJ "
=>JJ# %
{KK 
tableLL 
.LL 

PrimaryKeyLL $
(LL$ %
$strLL% 2
,LL2 3
xLL4 5
=>LL6 8
newLL9 <
{LL= >
xLL? @
.LL@ A
RoleIdLLA G
,LLG H
xLLI J
.LLJ K
UserIdLLK Q
}LLR S
)LLS T
;LLT U
tableMM 
.MM 

ForeignKeyMM $
(MM$ %
nameNN 
:NN 
$strNN 8
,NN8 9
columnOO 
:OO 
xOO  !
=>OO" $
xOO% &
.OO& '
RoleIdOO' -
,OO- .
principalTablePP &
:PP& '
$strPP( /
,PP/ 0
principalColumnQQ '
:QQ' (
$strQQ) -
,QQ- .
onDeleteRR  
:RR  !
ReferentialActionRR" 3
.RR3 4
RestrictRR4 <
)RR< =
;RR= >
tableSS 
.SS 

ForeignKeySS $
(SS$ %
nameTT 
:TT 
$strTT 8
,TT8 9
columnUU 
:UU 
xUU  !
=>UU" $
xUU% &
.UU& '
UserIdUU' -
,UU- .
principalTableVV &
:VV& '
$strVV( /
,VV/ 0
principalColumnWW '
:WW' (
$strWW) -
,WW- .
onDeleteXX  
:XX  !
ReferentialActionXX" 3
.XX3 4
CascadeXX4 ;
)XX; <
;XX< =
}YY 
)YY 
;YY 
migrationBuilder[[ 
.[[ 
CreateIndex[[ (
([[( )
name\\ 
:\\ 
$str\\ %
,\\% &
table]] 
:]] 
$str]] 
,]] 
column^^ 
:^^ 
$str^^ 
,^^ 
unique__ 
:__ 
true__ 
)__ 
;__ 
migrationBuilderaa 
.aa 
CreateIndexaa (
(aa( )
namebb 
:bb 
$strbb -
,bb- .
tablecc 
:cc 
$strcc $
,cc$ %
columndd 
:dd 
$strdd  
)dd  !
;dd! "
migrationBuilderff 
.ff 
CreateIndexff (
(ff( )
namegg 
:gg 
$strgg *
,gg* +
tablehh 
:hh 
$strhh !
,hh! "
columnii 
:ii 
$strii  
)ii  !
;ii! "
}jj 	
	protectedll 
overridell 
voidll 
Downll  $
(ll$ %
MigrationBuilderll% 5
migrationBuilderll6 F
)llF G
{mm 	
migrationBuildernn 
.nn 
	DropTablenn &
(nn& '
nameoo 
:oo 
$stroo #
)oo# $
;oo$ %
migrationBuilderqq 
.qq 
	DropTableqq &
(qq& '
namerr 
:rr 
$strrr  
)rr  !
;rr! "
migrationBuildertt 
.tt 
	DropTablett &
(tt& '
nameuu 
:uu 
$struu 
)uu 
;uu 
migrationBuilderww 
.ww 
	DropTableww &
(ww& '
namexx 
:xx 
$strxx 
)xx 
;xx 
}yy 	
}zz 
}{{ ¶A
„D:\macrotracker\MacroTracker\Macrotracker.Users.Infrastructure\DataAccess\EfDataAccess\Migrations\20190120133809_cascade-restrict.cs
	namespace 	
MacroTracker
 
. 
Users 
. 
Infrastructure +
.+ ,

Migrations, 6
{ 
public 

partial 
class 
cascaderestrict (
:) *
	Migration+ 4
{ 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{		 	
migrationBuilder

 
.

 
DropForeignKey

 +
(

+ ,
name 
: 
$str 3
,3 4
table 
: 
$str $
)$ %
;% &
migrationBuilder 
. 
	DropTable &
(& '
name 
: 
$str  
)  !
;! "
migrationBuilder 
. 
	DropTable &
(& '
name 
: 
$str 
) 
; 
migrationBuilder 
. 
	AddColumn &
<& '
string' -
>- .
(. /
name 
: 
$str !
,! "
table 
: 
$str 
, 
nullable 
: 
false 
,  
defaultValue 
: 
$str  
)  !
;! "
migrationBuilder 
. 
AddForeignKey *
(* +
name 
: 
$str 3
,3 4
table 
: 
$str $
,$ %
column 
: 
$str  
,  !
principalTable 
: 
$str  '
,' (
principalColumn 
:  
$str! %
,% &
onDelete   
:   
ReferentialAction   +
.  + ,
Cascade  , 3
)  3 4
;  4 5
}!! 	
	protected## 
override## 
void## 
Down##  $
(##$ %
MigrationBuilder##% 5
migrationBuilder##6 F
)##F G
{$$ 	
migrationBuilder%% 
.%% 
DropForeignKey%% +
(%%+ ,
name&& 
:&& 
$str&& 3
,&&3 4
table'' 
:'' 
$str'' $
)''$ %
;''% &
migrationBuilder)) 
.)) 

DropColumn)) '
())' (
name** 
:** 
$str** !
,**! "
table++ 
:++ 
$str++ 
)++ 
;++  
migrationBuilder-- 
.-- 
CreateTable-- (
(--( )
name.. 
:.. 
$str.. 
,.. 
columns// 
:// 
table// 
=>// !
new//" %
{00 
Id11 
=11 
table11 
.11 
Column11 %
<11% &
Guid11& *
>11* +
(11+ ,
nullable11, 4
:114 5
false116 ;
)11; <
,11< =
	CreatedAt22 
=22 
table22  %
.22% &
Column22& ,
<22, -
DateTime22- 5
>225 6
(226 7
nullable227 ?
:22? @
false22A F
)22F G
,22G H
IsActive33 
=33 
table33 $
.33$ %
Column33% +
<33+ ,
bool33, 0
>330 1
(331 2
nullable332 :
:33: ;
false33< A
)33A B
,33B C
Name44 
=44 
table44  
.44  !
Column44! '
<44' (
string44( .
>44. /
(44/ 0
	maxLength440 9
:449 :
$num44; =
,44= >
nullable44? G
:44G H
false44I N
)44N O
,44O P
	UpdatedAt55 
=55 
table55  %
.55% &
Column55& ,
<55, -
DateTime55- 5
>555 6
(556 7
nullable557 ?
:55? @
false55A F
)55F G
}66 
,66 
constraints77 
:77 
table77 "
=>77# %
{88 
table99 
.99 

PrimaryKey99 $
(99$ %
$str99% /
,99/ 0
x991 2
=>993 5
x996 7
.997 8
Id998 :
)99: ;
;99; <
}:: 
):: 
;:: 
migrationBuilder<< 
.<< 
CreateTable<< (
(<<( )
name== 
:== 
$str==  
,==  !
columns>> 
:>> 
table>> 
=>>> !
new>>" %
{?? 
RoleId@@ 
=@@ 
table@@ "
.@@" #
Column@@# )
<@@) *
Guid@@* .
>@@. /
(@@/ 0
nullable@@0 8
:@@8 9
false@@: ?
)@@? @
,@@@ A
UserIdAA 
=AA 
tableAA "
.AA" #
ColumnAA# )
<AA) *
GuidAA* .
>AA. /
(AA/ 0
nullableAA0 8
:AA8 9
falseAA: ?
)AA? @
}BB 
,BB 
constraintsCC 
:CC 
tableCC "
=>CC# %
{DD 
tableEE 
.EE 

PrimaryKeyEE $
(EE$ %
$strEE% 2
,EE2 3
xEE4 5
=>EE6 8
newEE9 <
{EE= >
xEE? @
.EE@ A
RoleIdEEA G
,EEG H
xEEI J
.EEJ K
UserIdEEK Q
}EER S
)EES T
;EET U
tableFF 
.FF 

ForeignKeyFF $
(FF$ %
nameGG 
:GG 
$strGG 8
,GG8 9
columnHH 
:HH 
xHH  !
=>HH" $
xHH% &
.HH& '
RoleIdHH' -
,HH- .
principalTableII &
:II& '
$strII( /
,II/ 0
principalColumnJJ '
:JJ' (
$strJJ) -
,JJ- .
onDeleteKK  
:KK  !
ReferentialActionKK" 3
.KK3 4
RestrictKK4 <
)KK< =
;KK= >
tableLL 
.LL 

ForeignKeyLL $
(LL$ %
nameMM 
:MM 
$strMM 8
,MM8 9
columnNN 
:NN 
xNN  !
=>NN" $
xNN% &
.NN& '
UserIdNN' -
,NN- .
principalTableOO &
:OO& '
$strOO( /
,OO/ 0
principalColumnPP '
:PP' (
$strPP) -
,PP- .
onDeleteQQ  
:QQ  !
ReferentialActionQQ" 3
.QQ3 4
CascadeQQ4 ;
)QQ; <
;QQ< =
}RR 
)RR 
;RR 
migrationBuilderTT 
.TT 
CreateIndexTT (
(TT( )
nameUU 
:UU 
$strUU %
,UU% &
tableVV 
:VV 
$strVV 
,VV 
columnWW 
:WW 
$strWW 
,WW 
uniqueXX 
:XX 
trueXX 
)XX 
;XX 
migrationBuilderZZ 
.ZZ 
CreateIndexZZ (
(ZZ( )
name[[ 
:[[ 
$str[[ *
,[[* +
table\\ 
:\\ 
$str\\ !
,\\! "
column]] 
:]] 
$str]]  
)]]  !
;]]! "
migrationBuilder__ 
.__ 
AddForeignKey__ *
(__* +
name`` 
:`` 
$str`` 3
,``3 4
tableaa 
:aa 
$straa $
,aa$ %
columnbb 
:bb 
$strbb  
,bb  !
principalTablecc 
:cc 
$strcc  '
,cc' (
principalColumndd 
:dd  
$strdd! %
,dd% &
onDeleteee 
:ee 
ReferentialActionee +
.ee+ ,
Restrictee, 4
)ee4 5
;ee5 6
}ff 	
}gg 
}hh à%
ˆD:\macrotracker\MacroTracker\Macrotracker.Users.Infrastructure\DataAccess\EfDataAccess\Migrations\20190124160315_added-requests-table.cs
	namespace 	
MacroTracker
 
. 
Users 
. 
Infrastructure +
.+ ,

Migrations, 6
{ 
public 

partial 
class 
addedrequeststable +
:, -
	Migration. 7
{ 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{		 	
migrationBuilder

 
.

 
CreateTable

 (
(

( )
name 
: 
$str (
,( )
columns 
: 
table 
=> !
new" %
{ 
Id 
= 
table 
. 
Column %
<% &
Guid& *
>* +
(+ ,
nullable, 4
:4 5
false6 ;
); <
,< =
	CreatedAt 
= 
table  %
.% &
Column& ,
<, -
DateTime- 5
>5 6
(6 7
nullable7 ?
:? @
falseA F
)F G
,G H
	UpdatedAt 
= 
table  %
.% &
Column& ,
<, -
DateTime- 5
>5 6
(6 7
nullable7 ?
:? @
falseA F
)F G
,G H
IsActive 
= 
table $
.$ %
Column% +
<+ ,
bool, 0
>0 1
(1 2
nullable2 :
:: ;
false< A
)A B
,B C
	TrainerId 
= 
table  %
.% &
Column& ,
<, -
Guid- 1
>1 2
(2 3
nullable3 ;
:; <
false= B
)B C
,C D
UserId 
= 
table "
." #
Column# )
<) *
Guid* .
>. /
(/ 0
nullable0 8
:8 9
false: ?
)? @
} 
, 
constraints 
: 
table "
=># %
{ 
table 
. 

PrimaryKey $
($ %
$str% :
,: ;
x< =
=>> @
xA B
.B C
IdC E
)E F
;F G
table 
. 

ForeignKey $
($ %
name 
: 
$str C
,C D
column 
: 
x  !
=>" $
x% &
.& '
	TrainerId' 0
,0 1
principalTable &
:& '
$str( /
,/ 0
principalColumn '
:' (
$str) -
,- .
onDelete  
:  !
ReferentialAction" 3
.3 4
Restrict4 <
)< =
;= >
table 
. 

ForeignKey $
($ %
name 
: 
$str @
,@ A
column   
:   
x    !
=>  " $
x  % &
.  & '
UserId  ' -
,  - .
principalTable!! &
:!!& '
$str!!( /
,!!/ 0
principalColumn"" '
:""' (
$str"") -
,""- .
onDelete##  
:##  !
ReferentialAction##" 3
.##3 4
Cascade##4 ;
)##; <
;##< =
}$$ 
)$$ 
;$$ 
migrationBuilder&& 
.&& 
CreateIndex&& (
(&&( )
name'' 
:'' 
$str'' 5
,''5 6
table(( 
:(( 
$str(( )
,(() *
column)) 
:)) 
$str)) #
)))# $
;))$ %
migrationBuilder++ 
.++ 
CreateIndex++ (
(++( )
name,, 
:,, 
$str,, 2
,,,2 3
table-- 
:-- 
$str-- )
,--) *
column.. 
:.. 
$str..  
)..  !
;..! "
}// 	
	protected11 
override11 
void11 
Down11  $
(11$ %
MigrationBuilder11% 5
migrationBuilder116 F
)11F G
{22 	
migrationBuilder33 
.33 
	DropTable33 &
(33& '
name44 
:44 
$str44 (
)44( )
;44) *
}55 	
}66 
}77 à&
zD:\macrotracker\MacroTracker\Macrotracker.Users.Infrastructure\DataAccess\EfDataAccess\Repositories\EfGenericRepository.cs
	namespace		 	
Macrotracker		
 
.		 
Users		 
.		 
Infrastructure		 +
.		+ ,

DataAccess		, 6
.		6 7
EfDataAccess		7 C
.		C D
Repositories		D P
{

 
public 

abstract 
class 
EfGenericRepository -
<- .
T. /
>/ 0
:1 2
IRepository3 >
<> ?
T? @
>@ A
whereB G
TH I
:J K
EntityL R
{ 
	protected 
UsersDbContext  
Context! (
{) *
get+ .
;. /
}0 1
	protected 
EfGenericRepository %
(% &
UsersDbContext& 4
context5 <
)< =
=>> @
ContextA H
=I J
contextK R
;R S
public 
virtual 
T 
Add 
( 
T 
entity %
)% &
{ 	
Context 
. 
Add 
( 
entity 
) 
;  
Context 
. 
SaveChanges 
(  
)  !
;! "
return 
entity 
; 
} 	
public 
virtual 
void 
Delete "
(" #
T# $
entity% +
)+ ,
{ 	
Context 
. 
Remove 
( 
entity !
)! "
;" #
Context 
. 
SaveChanges 
(  
)  !
;! "
} 	
public 
virtual 
void 
Delete "
(" #
Guid# '
id( *
)* +
{ 	
var   
entity   
=   
Context    
.    !
Set  ! $
<  $ %
T  % &
>  & '
(  ' (
)  ( )
.  ) *
Find  * .
(  . /
id  / 1
)  1 2
;  2 3
Delete!! 
(!! 
entity!! 
)!! 
;!! 
}"" 	
public$$ 
virtual$$ 
IEnumerable$$ "
<$$" #
T$$# $
>$$$ %
Get$$& )
($$) *

Expression$$* 4
<$$4 5
Func$$5 9
<$$9 :
T$$: ;
,$$; <
bool$$= A
>$$A B
>$$B C
	predicate$$D M
,$$M N
int$$O R
perPage$$S Z
,$$Z [
int$$\ _

pageNumber$$` j
)$$j k
=>%% 
Context%% 
.%% 
Set%% 
<%% 
T%% 
>%% 
(%% 
)%% 
.%%  
Where%%  %
(%%% &
	predicate%%& /
)%%/ 0
.%%0 1
Take%%1 5
(%%5 6
perPage%%6 =
)%%= >
.%%> ?
Skip%%? C
(%%C D
(%%D E

pageNumber%%E O
-%%P Q
$num%%R S
)%%S T
*%%U V
perPage%%W ^
)%%^ _
;%%_ `
public'' 
virtual'' 
IEnumerable'' "
<''" #
T''# $
>''$ %
Get''& )
('') *

Expression''* 4
<''4 5
Func''5 9
<''9 :
T'': ;
,''; <
bool''= A
>''A B
>''B C
	predicate''D M
)''M N
=>''O Q
Context''R Y
.''Y Z
Set''Z ]
<''] ^
T''^ _
>''_ `
(''` a
)''a b
.''b c
Where''c h
(''h i
	predicate''i r
)''r s
;''s t
public)) 
virtual)) 
T)) 
Get)) 
()) 
Guid)) !
id))" $
)))$ %
=>))& (
Context))) 0
.))0 1
Set))1 4
<))4 5
T))5 6
>))6 7
())7 8
)))8 9
.))9 :
Find)): >
())> ?
id))? A
)))A B
;))B C
public++ 
virtual++ 
void++ 
Update++ "
(++" #
T++# $
entity++% +
)+++ ,
{,, 	
Context-- 
.-- 
Entry-- 
(-- 
entity--  
)--  !
.--! "
State--" '
=--( )
	Microsoft--* 3
.--3 4
EntityFrameworkCore--4 G
.--G H
EntityState--H S
.--S T
Modified--T \
;--\ ]
Context.. 
... 
SaveChanges.. 
(..  
)..  !
;..! "
}// 	
}00 
}11 ÿ
zD:\macrotracker\MacroTracker\Macrotracker.Users.Infrastructure\DataAccess\EfDataAccess\Repositories\EfTrainerRepository.cs
	namespace

 	
Macrotracker


 
.

 
Users

 
.

 
Infrastructure

 +
.

+ ,

DataAccess

, 6
.

6 7
EfDataAccess

7 C
.

C D
Repositories

D P
{ 
public 

class 
EfTrainerRepository $
:% &
EfGenericRepository' :
<: ;
Trainer; B
>B C
,C D
ITrainerRepositoryE W
{ 
public 
EfTrainerRepository "
(" #
UsersDbContext# 1
context2 9
)9 :
:; <
base= A
(A B
contextB I
)I J
{ 	
} 	
public 
void !
AcceptTrainingRequest )
() *
Guid* .
	requestId/ 8
)8 9
{ 	
var 
request 
= 
Context !
.! "
TrainingRequests" 2
.2 3
Include 
( 
tr 
=> 
tr  
.  !
Trainer! (
)( )
. 
ThenInclude 
( 
t 
=> !
t" #
.# $
TrainerUsers$ 0
)0 1
.1 2
Where2 7
(7 8
r8 9
=>: <
r= >
.> ?
Id? A
==B D
	requestIdE N
)N O
.O P
FirstOrDefaultP ^
(^ _
)_ `
;` a
if 
( 
request 
== 
null 
)  
throw 
new #
EntityNotFoundException 1
(1 2
	requestId2 ;
,; <
$str= N
)N O
;O P
if 
( 
request 
. 
Trainer 
.  
TrainerUsers  ,
., -
Any- 0
(0 1
tu1 3
=>4 6
tu7 9
.9 :
UserId: @
==A C
requestD K
.K L
UserIdL R
)R S
)S T
throw 
new (
EntityAlreadyExistsException 6
(6 7
$str7 `
)` a
;a b
var 
userTrainer 
= 
new !
TrainerUser" -
{ 
	TrainerId   
=   
request   #
.  # $
	TrainerId  $ -
,  - .
UserId!! 
=!! 
request!!  
.!!  !
UserId!!! '
}"" 
;"" 
request$$ 
.$$ 
IsActive$$ 
=$$ 
false$$ $
;$$$ %
Context&& 
.&& 
Entry&& 
(&& 
userTrainer&& %
)&&% &
.&&& '
State&&' ,
=&&- .
EntityState&&/ :
.&&: ;
Added&&; @
;&&@ A
Context(( 
.(( 
SaveChanges(( 
(((  
)((  !
;((! "
})) 	
}** 
}++ ¢
‚D:\macrotracker\MacroTracker\Macrotracker.Users.Infrastructure\DataAccess\EfDataAccess\Repositories\EfTrainingRequestRepository.cs
	namespace 	
Macrotracker
 
. 
Users 
. 
Infrastructure +
.+ ,

DataAccess, 6
.6 7
EfDataAccess7 C
.C D
RepositoriesD P
{ 
public 

class '
EfTrainingRequestRepository ,
:- .
EfGenericRepository/ B
<B C
TrainingRequestC R
>R S
,S T&
ITrainingRequestRepositoryU o
{ 
public		 '
EfTrainingRequestRepository		 *
(		* +
UsersDbContext		+ 9
context		: A
)		A B
:		C D
base		E I
(		I J
context		J Q
)		Q R
{

 	
} 	
} 
} ê
wD:\macrotracker\MacroTracker\Macrotracker.Users.Infrastructure\DataAccess\EfDataAccess\Repositories\EfUserRepository.cs
	namespace 	
Macrotracker
 
. 
Users 
. 
Infrastructure +
.+ ,

DataAccess, 6
.6 7
EfDataAccess7 C
.C D
RepositoriesD P
{ 
public 

class 
EfUserRepository !
:" #
EfGenericRepository$ 7
<7 8
User8 <
>< =
,= >
IUserRepository? N
{ 
public		 
EfUserRepository		 
(		  
UsersDbContext		  .
context		/ 6
)		6 7
:		8 9
base		: >
(		> ?
context		? F
)		F G
{

 	
} 	
} 
} µ
hD:\macrotracker\MacroTracker\Macrotracker.Users.Infrastructure\DataAccess\EfDataAccess\UsersDbContext.cs
	namespace

 	
MacroTracker


 
.

 
Users

 
.

 
Infrastructure

 +
{ 
public 

class 
UsersDbContext 
:  !
	DbContext" +
{ 
public 
UsersDbContext 
( 
DbContextOptions .
options/ 6
)6 7
:8 9
base: >
(> ?
options? F
)F G
{ 	
} 	
	protected 
override 
void 
OnModelCreating  /
(/ 0
ModelBuilder0 <
modelBuilder= I
)I J
{ 	
modelBuilder 
. 
ApplyConfiguration +
(+ ,
new, /
UserConfiguration0 A
(A B
)B C
)C D
;D E
modelBuilder 
. 
ApplyConfiguration +
(+ ,
new, / 
TrainerConfiguration0 D
(D E
)E F
)F G
;G H
modelBuilder 
. 
ApplyConfiguration +
(+ ,
new, /(
TrainingRequestConfiguration0 L
(L M
)M N
)N O
;O P
modelBuilder 
. !
ConfigureJoinEntities .
(. /
)/ 0
;0 1
base 
. 
OnModelCreating  
(  !
modelBuilder! -
)- .
;. /
} 	
public 
override 
int 
SaveChanges '
(' (
)( )
{ 	
var 
entries 
= 
ChangeTracker '
.' (
Entries( /
(/ 0
)0 1
;1 2
entries 
. $
SetCreatedUpdatedAtDates ,
(, -
)- .
;. /
return   
base   
.   
SaveChanges   #
(  # $
)  $ %
;  % &
}!! 	
public## 
DbSet## 
<## 
User## 
>## 
Users##  
{##! "
get### &
;##& '
set##( +
;##+ ,
}##- .
public$$ 
DbSet$$ 
<$$ 
Trainer$$ 
>$$ 
Trainers$$ &
{$$' (
get$$) ,
;$$, -
set$$. 1
;$$1 2
}$$3 4
public%% 
DbSet%% 
<%% 
TrainingRequest%% $
>%%$ %
TrainingRequests%%& 6
{%%7 8
get%%9 <
;%%< =
set%%> A
;%%A B
}%%C D
}&& 
}'' 